(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21e433"],{d58d:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("AdminLayout",[a("ModuleHeader",{scopedSlots:e._u([{key:"icon",fn:function(){return[e._v(" mdi-account ")]},proxy:!0},{key:"name",fn:function(){return[e._v(" USERS PMB ")]},proxy:!0},{key:"breadcrumbs",fn:function(){return[a("v-breadcrumbs",{staticClass:"pa-0",attrs:{items:e.breadcrumbs},scopedSlots:e._u([{key:"divider",fn:function(){return[a("v-icon",[e._v("mdi-chevron-right")])]},proxy:!0}])})]},proxy:!0},{key:"desc",fn:function(){return[a("v-alert",{attrs:{color:"cyan",border:"left","colored-border":"",type:"info"}},[e._v(" User dengan role PMB bertanggungjawab terhadap proses penerimaan mahasiswa baru. ")])]},proxy:!0}])}),a("v-container",[a("v-row",{staticClass:"mb-4",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[a("v-card",[a("v-card-text",[a("v-text-field",{attrs:{"append-icon":"mdi-database-search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1)],1)],1),a("v-row",{staticClass:"mb-4",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.daftar_users,search:e.search,"item-key":"id","sort-by":"name","show-expand":"",expanded:e.expanded,"single-expand":!0,loading:e.datatableLoading,"loading-text":"Loading... Please wait"},on:{"update:expanded":function(t){e.expanded=t},"click:row":e.dataTableRowClicked},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[e._v("DAFTAR USERS PMB")]),a("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),a("v-spacer"),a("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:"",loading:e.btnLoading,disabled:e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.showDialogTambahUserPMB(t)}}},[e._v(" TAMBAH ")]),a("v-dialog",{attrs:{"max-width":"500px",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-form",{ref:"frmdata",attrs:{"lazy-validation":""},model:{value:e.form_valid,callback:function(t){e.form_valid=t},expression:"form_valid"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),a("v-card-text",[a("v-text-field",{attrs:{label:"NAMA USER",filled:"",rules:e.rule_user_name},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}}),a("v-text-field",{attrs:{label:"EMAIL",filled:"",rules:e.rule_user_email},model:{value:e.editedItem.email,callback:function(t){e.$set(e.editedItem,"email",t)},expression:"editedItem.email"}}),a("v-text-field",{attrs:{label:"NOMOR HP",filled:"",rules:e.rule_user_nomorhp},model:{value:e.editedItem.nomor_hp,callback:function(t){e.$set(e.editedItem,"nomor_hp",t)},expression:"editedItem.nomor_hp"}}),a("v-text-field",{attrs:{label:"USERNAME",filled:"",rules:e.rule_user_username},model:{value:e.editedItem.username,callback:function(t){e.$set(e.editedItem,"username",t)},expression:"editedItem.username"}}),a("v-text-field",{attrs:{label:"PASSWORD",type:"password",filled:"",rules:e.rule_user_password},model:{value:e.editedItem.password,callback:function(t){e.$set(e.editedItem,"password",t)},expression:"editedItem.password"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return t.stopPropagation(),e.close(t)}}},[e._v("BATAL")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",loading:e.btnLoading,disabled:!e.form_valid||e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.save(t)}}},[e._v(" SIMPAN ")])],1)],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500px",persistent:""},model:{value:e.dialogEdit,callback:function(t){e.dialogEdit=t},expression:"dialogEdit"}},[a("v-form",{ref:"frmdata",attrs:{"lazy-validation":""},model:{value:e.form_valid,callback:function(t){e.form_valid=t},expression:"form_valid"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),a("v-card-text",[a("v-text-field",{attrs:{label:"NAMA USER",filled:"",rules:e.rule_user_name},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}}),a("v-text-field",{attrs:{label:"EMAIL",filled:"",rules:e.rule_user_email},model:{value:e.editedItem.email,callback:function(t){e.$set(e.editedItem,"email",t)},expression:"editedItem.email"}}),a("v-text-field",{attrs:{label:"NOMOR HP",filled:"",rules:e.rule_user_nomorhp},model:{value:e.editedItem.nomor_hp,callback:function(t){e.$set(e.editedItem,"nomor_hp",t)},expression:"editedItem.nomor_hp"}}),a("v-text-field",{attrs:{label:"USERNAME",filled:"",rules:e.rule_user_username},model:{value:e.editedItem.username,callback:function(t){e.$set(e.editedItem,"username",t)},expression:"editedItem.username"}}),a("v-text-field",{attrs:{label:"PASSWORD",type:"password",filled:"",rules:e.rule_user_passwordEdit},model:{value:e.editedItem.password,callback:function(t){e.$set(e.editedItem,"password",t)},expression:"editedItem.password"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return t.stopPropagation(),e.close(t)}}},[e._v("BATAL")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",loading:e.btnLoading,disabled:!e.form_valid||e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.save(t)}}},[e._v("SIMPAN")])],1)],1)],1)],1),a("v-dialog",{attrs:{"max-width":"800px",persistent:""},model:{value:e.dialogUserPermission,callback:function(t){e.dialogUserPermission=t},expression:"dialogUserPermission"}},[a("UserPermissions",{attrs:{user:e.editedItem,daftarpermissions:e.daftar_permissions,permissionsselected:e.permissions_selected},on:{closeUserPermissions:e.closeUserPermissions}})],1)],1)]},proxy:!0},{key:"item.actions",fn:function(t){var s=t.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:"",loading:e.btnLoading,disabled:e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.viewItem(s)}}},[e._v(" mdi-eye ")]),a("v-icon",{staticClass:"mr-2",attrs:{small:"",loading:e.btnLoading,disabled:e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.editItem(s)}}},[e._v(" mdi-pencil ")]),a("v-icon",{attrs:{small:"",loading:e.btnLoading,disabled:e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.deleteItem(s)}}},[e._v(" mdi-delete ")])]}},{key:"item.foto",fn:function(t){var s=t.item;return[a("v-avatar",{attrs:{size:"30"}},[a("v-img",{attrs:{src:e.$api.url+"/"+s.foto}})],1)]}},{key:"expanded-item",fn:function(t){var s=t.headers,r=t.item;return[a("td",{staticClass:"text-center",attrs:{colspan:s.length}},[a("v-col",{staticClass:"mb1",attrs:{cols:"12"}},[a("strong",[e._v("ID:")]),e._v(e._s(r.id)+" "),a("strong",[e._v("created_at:")]),e._v(e._s(e._f("formatTanggal")(r.created_at))+" "),a("strong",[e._v("updated_at:")]),e._v(e._s(e._f("formatTanggal")(r.created_at))+" ")])],1)]}},{key:"no-data",fn:function(){return[e._v(" Data belum tersedia ")]},proxy:!0}])})],1)],1)],1)],1)},r=[],i=(a("c975"),a("a434"),a("b0c0"),a("5530")),n=(a("96cf"),a("1da1")),o=a("2f62"),d=a("a1b3"),l=a("e477"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("USER PERMISSIONS")])]),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-row",{staticClass:"mb-4",attrs:{"no-gutters":""}},[a("v-col",{attrs:{xs:"12",sm:"12",md:"12"}},[a("v-card",[a("v-card-text",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("ID :")]),a("v-card-text",[e._v(" "+e._s(e.user.id)+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e(),a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("NOMOR HP :")]),a("v-card-text",[e._v(" "+e._s(e.user.nomor_hp)+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e()],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("USERNAME :")]),a("v-card-text",[e._v(" "+e._s(e.user.username)+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e(),a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("THEME :")]),a("v-card-text",[e._v(" "+e._s(e.user.theme)+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e()],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("NAMA :")]),a("v-card-text",[e._v(" "+e._s(e.user.name)+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e(),a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("CREATED :")]),a("v-card-text",[e._v(" "+e._s(e._f("formatTanggal")(e.user.created_at))+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e()],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("EMAIL :")]),a("v-card-text",[e._v(" "+e._s(e.user.email)+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e(),a("v-col",{attrs:{xs:"12",sm:"6",md:"6"}},[a("v-card",{attrs:{flat:""}},[a("v-card-title",[e._v("UPDATED :")]),a("v-card-text",[e._v(" "+e._s(e._f("formatTanggal")(e.user.updated_at))+" ")])],1)],1),e.$vuetify.breakpoint.xsOnly?a("v-responsive",{attrs:{width:"100%"}}):e._e()],1)],1)],1)],1)],1),a("v-row",{staticClass:"mb-4",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[a("v-card",[a("v-card-text",[a("v-text-field",{attrs:{"append-icon":"mdi-database-search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1)],1)],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{col:"12"}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.daftar_permissions,search:e.search,"item-key":"name","sort-by":"name","show-select":""},scopedSlots:e._u([{key:"item.actions",fn:function(t){var s=t.item;return[a("v-icon",{attrs:{small:"",loading:e.btnLoading,disabled:e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.revoke(s)}}},[e._v(" mdi-delete ")])]}}]),model:{value:e.permissions_selected,callback:function(t){e.permissions_selected=t},expression:"permissions_selected"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return t.stopPropagation(),e.close(t)}}},[e._v("KELUAR")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",loading:e.btnLoading,disabled:e.btnLoading||!e.perm_selected.length>0},on:{click:function(t){return t.stopPropagation(),e.save(t)}}},[e._v(" SIMPAN ")])],1)],1)},u=[],m={name:"UserPermissions",data:function(){return{btnLoading:!1,headers:[{text:"NAMA PERMISSION",value:"name"},{text:"GUARD",value:"guard_name"},{text:"AKSI",value:"actions",sortable:!1,width:100}],search:"",perm_selected:[],perm_revoked:[]}},methods:{save:function(){var e=this;this.btnLoading=!0,this.$ajax.post("/system/users/storeuserpermissions",{user_id:this.user.id,chkpermission:this.permissions_selected},{headers:{Authorization:this.TOKEN}}).then((function(){e.close()})).catch((function(){e.btnLoading=!1}))},revoke:function(e){var t=this;this.btnLoading=!0,this.$ajax.post("/system/users/revokeuserpermissions",{user_id:this.user.id,name:e.name},{headers:{Authorization:this.TOKEN}}).then((function(){t.close()})).catch((function(){t.btnLoading=!1}))},close:function(){this.btnLoading=!1,this.permissions_selected=[],this.$emit("closeUserPermissions")}},props:{user:Object,daftarpermissions:Array,permissionsselected:Array},computed:Object(i["a"])({},Object(o["b"])("auth",{TOKEN:"Token"}),{daftar_permissions:function(){return this.daftarpermissions},permissions_selected:{get:function(){return this.perm_selected.length>0?this.perm_selected:this.permissionsselected},set:function(e){this.perm_selected=e}}})},v=m,p=a("2877"),h=a("6544"),f=a.n(h),_=a("8336"),b=a("b0af"),g=a("99d9"),x=a("62ad"),k=a("a523"),I=a("8fea"),w=a("132d"),y=a("6b53"),A=a("0fd9"),E=a("2fa4"),P=a("8654"),L=Object(p["a"])(v,c,u,!1,null,null,null),T=L.exports;f()(L,{VBtn:_["a"],VCard:b["a"],VCardActions:g["a"],VCardText:g["b"],VCardTitle:g["c"],VCol:x["a"],VContainer:k["a"],VDataTable:I["a"],VIcon:w["a"],VResponsive:y["a"],VRow:A["a"],VSpacer:E["a"],VTextField:P["a"]});var O={name:"UsersPMB",created:function(){this.breadcrumbs=[{text:"HOME",disabled:!1,href:"/dashboard/"+this.ACCESS_TOKEN},{text:"SYSTEM",disabled:!1,href:"#"},{text:"USERS PMB",disabled:!0,href:"#"}],this.initialize()},data:function(){return{role_id:0,datatableLoading:!1,btnLoading:!1,headers:[{text:"",value:"foto"},{text:"USERNAME",value:"username"},{text:"NAME",value:"name"},{text:"EMAIL",value:"email"},{text:"NOMOR HP",value:"nomor_hp"},{text:"AKSI",value:"actions",sortable:!1,width:100}],expanded:[],search:"",daftar_users:[],daftar_permissions:[],permissions_selected:[],form_valid:!0,dialog:!1,dialogEdit:!1,dialogUserPermission:!1,editedIndex:-1,editedItem:{id:0,username:"",password:"",name:"",email:"",nomor_hp:"",created_at:"",updated_at:""},defaultItem:{id:0,username:"",password:"",name:"",email:"",nomor_hp:"",created_at:"",updated_at:""},rule_user_name:[function(e){return!!e||"Mohon untuk di isi nama User !!!"},function(e){return/^[A-Za-z\s]*$/.test(e)||"Nama User hanya boleh string dan spasi"}],rule_user_email:[function(e){return!!e||"Mohon untuk di isi email User !!!"},function(e){return/.+@.+\..+/.test(e)||"Format E-mail harus benar"}],rule_user_nomorhp:[function(e){return!!e||"Nomor HP mohon untuk diisi !!!"},function(e){return/^\+[1-9]{1}[0-9]{1,14}$/.test(e)||"Nomor HP hanya boleh angka dan gunakan kode negara didepan seperti +6281214553388"}],rule_user_username:[function(e){return!!e||"Mohon untuk di isi username User !!!"},function(e){return/^[A-Za-z_]*$/.test(e)||"Username hanya boleh string dan underscore"}],rule_user_password:[function(e){return!!e||"Mohon untuk di isi password User !!!"},function(e){return e.length>=8||"Minimial Password 8 karaketer"}],rule_user_passwordEdit:[function(e){return!(e.length>0)||(e.length>=8||"Minimial Password 8 karaketer")}]}},methods:{initialize:function(){var e=this;this.datatableLoading=!0,this.$ajax.get("/system/userspmb",{headers:{Authorization:this.TOKEN}}).then((function(t){var a=t.data;e.daftar_users=a.userspmb,e.role_id=a.role.id,e.datatableLoading=!1}))},dataTableRowClicked:function(e){e===this.expanded[0]?this.expanded=[]:this.expanded=[e]},showDialogTambahUserPMB:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.dialog=!0;case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),editItem:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.editedIndex=this.daftar_users.indexOf(t),t.password="",this.editedItem=Object.assign({},t),this.dialogEdit=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),viewItem:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.btnLoading=!0,this.$ajax.get("/system/setting/roles/"+this.role_id+"/permission",{headers:{Authorization:this.TOKEN}}).then((function(e){var t=e.data;a.daftar_permissions=t.permissions})).catch((function(){a.btnLoading=!1})),e.next=4,this.$ajax.get("/system/users/"+t.id+"/permission",{headers:{Authorization:this.TOKEN}}).then((function(e){var t=e.data;a.permissions_selected=t.permissions,a.btnLoading=!1})).catch((function(){a.btnLoading=!1}));case 4:this.dialogUserPermission=!0,this.editedItem=t;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),close:function(){var e=this;this.$refs.frmdata.resetValidation(),this.btnLoading=!1,this.dialog=!1,this.dialogEdit=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},closeUserPermissions:function(){this.btnLoading=!1,this.permissions_selected=[],this.dialogUserPermission=!1},save:function(){var e=this;this.$refs.frmdata.validate()&&(this.btnLoading=!0,this.editedIndex>-1?this.$ajax.post("/system/userspmb/"+this.editedItem.id,{_method:"PUT",name:this.editedItem.name,email:this.editedItem.email,nomor_hp:this.editedItem.nomor_hp,username:this.editedItem.username,password:this.editedItem.password},{headers:{Authorization:this.TOKEN}}).then((function(t){var a=t.data;Object.assign(e.daftar_users[e.editedIndex],a.user),e.close()})).catch((function(){e.btnLoading=!1})):this.$ajax.post("/system/userspmb/store",{name:this.editedItem.name,email:this.editedItem.email,nomor_hp:this.editedItem.nomor_hp,username:this.editedItem.username,password:this.editedItem.password},{headers:{Authorization:this.TOKEN}}).then((function(t){var a=t.data;e.daftar_users.push(a.user),e.close()})).catch((function(){e.btnLoading=!1})))},deleteItem:function(e){var t=this;this.$root.$confirm.open("Delete","Apakah Anda ingin menghapus username "+e.username+" ?",{color:"red"}).then((function(a){a&&(t.btnLoading=!0,t.$ajax.post("/system/userspmb/"+e.id,{_method:"DELETE"},{headers:{Authorization:t.TOKEN}}).then((function(){var a=t.daftar_users.indexOf(e);t.daftar_users.splice(a,1),t.btnLoading=!1})).catch((function(){t.btnLoading=!1})))}))}},computed:Object(i["a"])({formTitle:function(){return-1===this.editedIndex?"TAMBAH USER PMB":"EDIT USER PMB"}},Object(o["b"])("auth",{ACCESS_TOKEN:"AccessToken",TOKEN:"Token"})),watch:{dialog:function(e){e||this.close()},dialogEdit:function(e){e||this.close()}},components:{AdminLayout:d["a"],ModuleHeader:l["a"],UserPermissions:T}},M=O,S=a("0798"),U=a("8212"),$=a("2bc5"),C=a("169a"),R=a("ce7e"),V=a("4bd4"),N=a("adda"),j=a("71d9"),D=a("2a7f"),B=Object(p["a"])(M,s,r,!1,null,null,null);t["default"]=B.exports;f()(B,{VAlert:S["a"],VAvatar:U["a"],VBreadcrumbs:$["a"],VBtn:_["a"],VCard:b["a"],VCardActions:g["a"],VCardText:g["b"],VCardTitle:g["c"],VCol:x["a"],VContainer:k["a"],VDataTable:I["a"],VDialog:C["a"],VDivider:R["a"],VForm:V["a"],VIcon:w["a"],VImg:N["a"],VRow:A["a"],VSpacer:E["a"],VTextField:P["a"],VToolbar:j["a"],VToolbarTitle:D["a"]})}}]);